---
import BlogLayout from '../../layouts/BlogLayout.astro';
import { getCollection } from 'astro:content';

// Get all blog posts
const allPosts = await getCollection('blog');

// Sort posts by date
const sortedPosts = allPosts.sort(
  (a, b) => new Date(b.data.pubDate).valueOf() - new Date(a.data.pubDate).valueOf()
);
---

<BlogLayout title="My Blog" description="Read my latest thoughts, tutorials, and insights">
  <div class="blog-index">
    <h1>My Blog</h1>
    <p class="intro">Welcome to my blog where I share my thoughts, experiences, and insights.</p>
    
    <div class="posts-grid">
      {sortedPosts.map((post) => (
        <div class="post-card">
          {post.data.image && (
            <div class="post-image">
              <img src={post.data.image} alt={post.data.title} />
            </div>
          )}
          <div class="post-content">
            <h2>
              <a href={`/blog/${post.slug}`}>{post.data.title}</a>
            </h2>
            <div class="post-meta">
              <span class="date">
                {new Date(post.data.pubDate).toLocaleDateString('en-us', {
                  year: 'numeric',
                  month: 'short',
                  day: 'numeric',
                })}
              </span>
            </div>
            <p class="excerpt">{post.data.description}</p>
            <a href={`/blog/${post.slug}`} class="read-more">Read More â†’</a>
          </div>
        </div>
      ))}
    </div>
    
    {sortedPosts.length === 0 && (
      <div class="no-posts">
        <p>No blog posts found. Check back soon!</p>
      </div>
    )}
  </div>
</BlogLayout>

<style>
  .blog-index {
    max-width: 1000px;
    margin: 0 auto;
  }
  
  h1 {
    font-size: 2.5rem;
    margin-bottom: 1rem;
  }
  
  .intro {
    font-size: 1.2rem;
    color: #666;
    margin-bottom: 3rem;
  }
  
  .posts-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 2rem;
  }
  
  .post-card {
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease;
  }
  
  .post-card:hover {
    transform: translateY(-5px);
  }
  
  .post-image img {
    width: 100%;
    height: 200px;
    object-fit: cover;
  }
  
  .post-content {
    padding: 1.5rem;
  }
  
  .post-content h2 {
    font-size: 1.5rem;
    margin-bottom: 0.5rem;
  }
  
  .post-content h2 a {
    color: inherit;
    text-decoration: none;
  }
  
  .post-meta {
    color: #666;
    font-size: 0.9rem;
    margin-bottom: 1rem;
  }
  
  .excerpt {
    color: #444;
    margin-bottom: 1rem;
  }
  
  .read-more {
    display: inline-block;
    color: #0077cc;
    text-decoration: none;
    font-weight: 500;
  }
  
  .no-posts {
    text-align: center;
    padding: 3rem 0;
    color: #666;
  }
  
  @media (max-width: 768px) {
    .posts-grid {
      grid-template-columns: 1fr;
    }
  }
</style> 